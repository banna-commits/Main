# 2026-02-17

## Telegram Webhook Migration
- Knut reported ~8 min delay on Telegram replies vs instant on webchat
- Switched Telegram from long polling to webhook mode
- Config: `webhookUrl: https://knut-sin-mac-mini.tail37c89c.ts.net/telegram-webhook`
- Generated webhookSecret, applied via config.patch, gateway restarted
- Doctor confirms webhook registered: `Telegram: ok (@BottenAnna26bot) - webhook ...`
- Tailscale Funnel root `/` proxies to gateway 18789, so `/telegram-webhook` routes through
- POST to localhost:18789/telegram-webhook returns 405 (likely secret validation) — endpoint exists
- Still unconfirmed if Knut's Telegram messages are coming through — needs testing
- Root cause: removing webhookUrl/webhookSecret from config does NOT delete the webhook from Telegram's side
- Fix: `curl "https://api.telegram.org/bot<token>/deleteWebhook"` then restart gateway
- Lesson: always call deleteWebhook on Telegram API before reverting to polling
